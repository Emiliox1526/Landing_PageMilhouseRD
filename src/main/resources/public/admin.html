<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Administrar propiedad | MILHOUSE RD</title>

    <!-- Bootstrap + Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>

    <!-- CSS del proyecto -->
    <link rel="stylesheet" href="css/header.css"/>

    <!-- Fuente (misma que en el proyecto) -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">

    <!-- Leaflet (Mapa) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

    <style>
        :root{
            --mh-ink:#0B1220;
            --mh-navy:#0F1B2D;
            --mh-navy-2:#142742;
            --mh-bg:#E7EBF3;
            --mh-line:#E7EBF3;
            --header-h:68px;
        }
        html,body{ background: var(--mh-bg) !important; font-family:"Montserrat",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--mh-ink); }

        /* Header fijo sin tapar contenido */
        body.admin-compact{ padding-top: var(--header-h); }
        body.admin-compact header{
            position: fixed; inset:0 0 auto 0; z-index: 1000;
            backdrop-filter: blur(6px);
            background: rgba(0,0,0,.05);
            box-shadow: 0 6px 20px rgba(16,24,40,.06);
        }

        .custom-padding { padding: 24px; }
        .section-card{ border-radius: 18px; background:var(--mh-bg); box-shadow:0 6px 20px rgba(16,24,40,.06); }

        /* ===== Secci√≥n Propiedades ===== */
        .properties{ background:var(--mh-bg) !important; padding:2rem 1rem; border-radius:18px; }

        /* ===== Filtros (coherente con index: colapsable en m√≥vil, sticky en desktop) ===== */
        #filtersCol{ align-self:flex-start; }
        @media (min-width: 992px){ #filtersCol{ position: sticky; top: 88px; } }

        .filters-card .card-header{ background:transparent; border:0; padding:0 0 .75rem; }
        .filters-card .title{ font-weight:800; color:var(--mh-ink); margin:0; }
        .filters-card .form-label{ font-weight:500; color:var(--mh-navy); }
        
        /* Mejoras de contraste para accesibilidad */
        .form-text, .text-muted, small.text-muted { 
            color: #4a5568 !important; 
            font-weight: 500;
        }
        #priceHint, #areaHint, #priceRangeHint {
            color: #2d3748 !important;
            font-size: 0.875rem;
            font-weight: 500;
            line-height: 1.4;
        }
        #priceRangeHint {
            color: #059669 !important;
            font-weight: 600;
        }

        .mh-input,.mh-select{
            border-radius:14px !important; border:1.5px solid var(--mh-line) !important; background:#fff !important;
            box-shadow:none !important; padding:.62rem .85rem !important; font-weight:600; color:var(--mh-ink);
        }
        .mh-input:focus,.mh-select:focus{
            outline:0; border-color:transparent !important; box-shadow:0 0 0 3px rgba(15,27,45,.12) !important;
        }
        .mh-select{
            appearance:none;
            background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23142742' viewBox='0 0 16 16'><path d='M4.646 6.646a.5.5 0 0 1 .708 0L8 9.293l2.646-2.647a.5.5 0 0 1 .708.708L8.354 10.354a.5.5 0 0 1-.708 0L4.646 7.354a.5.5 0 0 1 0-.708z'/></svg>");
            background-repeat:no-repeat; background-position:right .8rem center; background-size:16px 16px; padding-right:2.2rem !important;
        }

        .btn-primary{
            background:linear-gradient(135deg,var(--mh-navy),var(--mh-navy-2)) !important;
            color:#fff; border-radius:1.25rem; border:0 !important;
        }
        .btn-primary:hover{ filter:brightness(1.05); }
        .btn-secondary{
            background:#23324a; color:#fff; border-radius:1.25rem; border:0 !important;
        }
        .btn-secondary:hover{ filter:brightness(1.05); }

        /* Toolbar + segmented */
        .toolbar-card .card-body{ padding:.8rem 1rem; }
        .segmented{
            display:flex; flex-wrap:wrap; gap:.5rem;
            background:#f1f3f7; border:1.5px solid #e3e7ef; border-radius:9999px; padding:.35rem;
        }
        .seg-btn{
            border:0; background:transparent; border-radius:9999px;
            padding:.45rem .9rem; font-weight:500; color:#23324a; cursor:pointer; opacity:.9;
        }
        .seg-btn[aria-pressed="true"]{
            background:linear-gradient(135deg,var(--mh-navy),var(--mh-navy-2)); color:#fff; opacity:1;
        }
        .visually-hidden{
            position:absolute !important; width:1px; height:1px; padding:0; margin:-1px;
            overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;
        }

        /* Cards del admin (con men√∫ 3 puntos) */
        .properties .card{
            border:0; border-radius:20px; background:#fff;
            box-shadow:0 6px 20px rgba(16,24,40,.06);
            overflow:hidden; transition:transform .2s ease, box-shadow .2s ease;
            position: relative;
        }
        .properties .card:hover{ transform:translateY(-4px); box-shadow:0 12px 28px rgba(16,24,40,.10); }
        .properties .card .ratio{ --bs-aspect-ratio: 56.25%; }
        .properties .card img{ width:100%; height:100%; object-fit:cover; }
        .badge.text-bg-primary{ background:linear-gradient(135deg,var(--mh-navy),var(--mh-navy-2)) !important; }
        .badge.text-bg-secondary{ background:#23324a !important; }
        .properties .card .card-menu{ position: absolute; right: 12px; bottom: 12px; z-index: 2; }
        .properties .card .card-body{ padding-bottom: 3rem; }

        /* Paginaci√≥n */
        .ta-pagination .page-link{ border-radius:999px; border:1.5px solid var(--mh-line); background:#fff; font-weight:700; }
        .ta-pagination .page-item + .page-item .page-link{ margin-left:.4rem; }
        .ta-pagination .page-item.active .page-link{ color:#fff; background:linear-gradient(135deg,var(--mh-navy),var(--mh-navy-2)); border-color:transparent; }
        .ta-pagination .page-item.disabled .page-link{ background:#f4f6fa; color:#9aa1b3; border-color:var(--mh-line); }

        /* Modal responsivo y consistente */
        .modal-dialog{ margin: .5rem; }
        @media (min-width: 576px){ .modal-dialog{ margin: 1.25rem auto; } }
        .modal-body{ overflow-y: auto; }

        /* Mapa selector */
        .map-picker{ height: 360px; border: 1px solid #fff; border-radius: 12px; overflow: hidden; }

        /* Chips */
        .chip-input { gap:.5rem; }
        .chip-list{ display:flex; flex-wrap:wrap; gap:.5rem; }
        .chip{
            display:inline-flex; align-items:center; gap:.5rem;
            background:#f1f3f5; border:1px solid #e5e7eb; border-radius:999px; padding:.25rem .6rem; font-size:.875rem;
        }
        .chip .chip-remove{ border:0; background:transparent; line-height:1; cursor:pointer; font-weight:700; }

        /* Previews de im√°genes */
        .image-grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:.75rem; }
        .image-item{ position:relative; border-radius:12px; overflow:hidden; border:1px solid #e9ecef; background:#f8f9fa; }
        .image-item img{ width:100%; height:100px; object-fit:cover; display:block; }
        .image-item .remove{
            position:absolute; top:6px; right:6px; border:0; border-radius:999px;
            width:28px; height:28px; display:flex; align-items:center; justify-content:center;
            background:rgba(0,0,0,.55); color:#fff; cursor:pointer;
        }
        .image-item .progress-bar-container {
            position: absolute; bottom: 0; left: 0; right: 0; height: 4px; background: rgba(0,0,0,0.2);
        }
        .image-item .progress-bar {
            height: 100%; background: #0d6efd; transition: width 0.3s ease;
        }
        
        /* Drag and Drop Zone */
        .image-drop-zone {
            border: 2px dashed #cbd5e0;
            border-radius: 14px;
            padding: 2rem;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .image-drop-zone:hover {
            border-color: #0d6efd;
            background: #e7f3ff;
        }
        .image-drop-zone.drag-over {
            border-color: #0d6efd;
            background: #cfe2ff;
            transform: scale(1.02);
        }
        .image-drop-zone i {
            color: #6c757d;
        }
        .image-drop-zone:hover i {
            color: #0d6efd;
        }

        /* Modal refinado */
        #propertyModal .modal-dialog{
            margin: 1.25rem auto;
            max-width: 1140px;
            height: calc(100dvh - 2.5rem);
        }
        #propertyModal .modal-content{
            border: 0; border-radius: 20px; background: #fff; box-shadow: 0 12px 28px rgba(16,24,40,.10);
            display: flex; flex-direction: column; overflow: hidden;
        }
        #propertyModal .modal-header{
            border: 0; padding: 1rem 1.25rem;
            background: var(--mh-navy, #142742); color: #fff;
        }
        #propertyModal .modal-title{ font-weight: 800; color: #fff; }
        #propertyModal .btn-close{ filter: invert(1) brightness(200%); opacity: .9; }
        #propertyModal .btn-close:hover{ opacity: 1; }
        #propertyModal .modal-body{ padding: 1.25rem; overflow: auto; flex: 1 1 auto; }
        #propertyModal .modal-footer{ border-top: 1px solid var(--mh-line); padding: .85rem 1.25rem; background: #fff; }

        /* Inputs del modal con look mh-* */
        #propertyModal .form-label{ font-weight: 500; color: var(--mh-navy); }
        #propertyModal .form-control,#propertyModal .form-select{
            border-radius: 14px !important; border: 1.5px solid var(--mh-line) !important;
            background: #fff !important; box-shadow: none !important; padding: .62rem .85rem !important;
            font-weight: 600; color: var(--mh-ink);
        }
        #propertyModal .form-control:focus,#propertyModal .form-select:focus{
            outline: 0; border-color: transparent !important; box-shadow: 0 0 0 3px rgba(15,27,45,.12) !important;
        }
        #propertyModal .form-select{
            appearance: none;
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23142742' viewBox='0 0 16 16'><path d='M4.646 6.646a.5.5 0 0 1 .708 0L8 9.293l2.646-2.647a.5.5 0 0 1 .708.708L8.354 10.354a.5.5 0 0 1-.708 0L4.646 7.354a.5.5 0 0 1 0-.708z'/></svg>");
            background-repeat: no-repeat; background-position: right .8rem center; background-size: 16px 16px; padding-right: 2.2rem !important;
        }

        /* Backdrop suave */
        .modal-backdrop.show{ opacity: .4; }
    </style>
</head>
<body class="admin-compact">
<!-- HEADER include -->
<div id="header-container"></div>

<div class="container custom-padding">
    <!-- Toolbar superior -->
    <div class="section-card mb-3">
        <div class="card-header bg-transparent border-0">
            <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
                <div class="d-flex align-items-center gap-2">
                    <button id="btnOpenCreateToolbar" class="btn btn-primary">
                        <i class="bi bi-plus-circle me-2"></i>Crear propiedad
                    </button>
                    <button id="btnReloadList" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-repeat me-1"></i>Recargar
                    </button>
                </div>
                <div class="small text-muted">
                    <span id="resultsCount"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Secci√≥n propiedades -->
    <section class="properties" id="properties">
        <div class="row">
            <!-- Filtros -->
            <aside class="col-lg-3 mb-3" id="filtersCol">
                <!-- Bot√≥n colapsable en m√≥vil -->
                <button class="btn btn-primary w-100 d-lg-none mb-2" type="button"
                        data-bs-toggle="collapse" data-bs-target="#filtersCollapse"
                        aria-expanded="false" aria-controls="filtersCollapse">
                    <i class="bi bi-funnel me-2"></i> Filtros
                </button>

                <div id="filtersCollapse" class="collapse d-lg-block show">
                    <div class="section-card filters-card">
                        <div class="card-header"><h3 class="title">Filtrar b√∫squeda</h3></div>
                        <div class="card-body">
                            <form id="filtersForm" class="row g-3 align-items-end" novalidate>
                                <div class="col-12">
                                    <label for="q" class="form-label">Buscar</label>
                                    <input id="q" type="search" class="form-control mh-input" placeholder="T√≠tulo, sector, ciudad‚Ä¶">
                                </div>

                                <div class="col-12">
                                    <label for="fType" class="form-label">Tipo de Propiedad</label>
                                    <select id="fType" class="form-select mh-select">
                                        <option value="">Todos</option>
                                        <option>Apartamento</option><option>Casa</option><option>Penthouse</option>
                                        <option>Solar</option><option>Villa</option><option>Local Comercial</option>
                                    </select>
                                </div>

                                <div class="col-12">
                                    <label for="fSaleType" class="form-label">Transacci√≥n</label>
                                    <select id="fSaleType" class="form-select mh-select">
                                        <option value="">Venta / Alquiler</option>
                                        <option>Venta</option><option>Alquiler</option>
                                    </select>
                                </div>

                                <div class="col-12">
                                    <label class="form-label">Rango de precio</label>
                                    <div class="row g-2">
                                        <div class="col-6"><input id="fMin" type="number" class="form-control mh-input" min="0" step="1000" placeholder="M√≠nimo"></div>
                                        <div class="col-6"><input id="fMax" type="number" class="form-control mh-input" min="0" step="1000" placeholder="M√°ximo"></div>
                                    </div>
                                </div>

                                <div class="col-12 d-grid gap-2">
                                    <button class="btn btn-primary" type="submit">Filtrar</button>
                                    <button class="btn btn-secondary" id="resetFilters" type="button">Reestablecer</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Listado -->
            <div class="col-lg-9 pb-5">
                <!-- Toolbar de orden/tama√±o -->
                <div class="section-card toolbar-card mb-3">
                    <div class="card-body d-flex justify-content-between align-items-center flex-wrap gap-2 ta-toolbar">
                        <div class="d-flex flex-wrap align-items-center gap-3">
                            <div class="d-flex flex-column gap-1">
                                <span class="small fw-bold text-muted">Orden</span>
                                <div id="sortSegment" class="segmented" role="group" aria-label="Ordenar">
                                    <button type="button" class="seg-btn" data-sort="createdAt-desc" aria-pressed="true">Recientes</button>
                                    <button type="button" class="seg-btn" data-sort="price-asc">Precio ‚Üë</button>
                                    <button type="button" class="seg-btn" data-sort="price-desc">Precio ‚Üì</button>
                                    <button type="button" class="seg-btn" data-sort="area-asc">√Årea ‚Üë</button>
                                    <button type="button" class="seg-btn" data-sort="area-desc">√Årea ‚Üì</button>
                                </div>
                            </div>

                            <div class="d-flex flex-column gap-1">
                                <span class="small fw-bold text-muted">Por p√°gina</span>
                                <div id="pageSizeSegment" class="segmented" role="group" aria-label="Por p√°gina">
                                    <button type="button" class="seg-btn" data-size="6">6</button>
                                    <button type="button" class="seg-btn" data-size="9" aria-pressed="true">9</button>
                                    <button type="button" class="seg-btn" data-size="12">12</button>
                                    <button type="button" class="seg-btn" data-size="18">18</button>
                                </div>
                            </div>

                            <!-- Selects reales (ocultos) que usa admin.js -->
                            <label class="visually-hidden" for="sortBy">Orden</label>
                            <select id="sortBy" class="visually-hidden">
                                <option value="createdAt-desc" selected>M√°s recientes</option>
                                <option value="price-asc">Precio ‚Üë</option>
                                <option value="price-desc">Precio ‚Üì</option>
                                <option value="area-desc">√Årea ‚Üì</option>
                                <option value="area-asc">√Årea ‚Üë</option>
                            </select>

                            <label class="visually-hidden" for="pageSize">Por p√°gina</label>
                            <select id="pageSize" class="visually-hidden">
                                <option value="6">6</option>
                                <option value="9" selected>9</option>
                                <option value="12">12</option>
                                <option value="18">18</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Tarjetas -->
                <div id="propertiesContainer" class="row g-3"></div>

                <!-- Paginaci√≥n -->
                <div class="section-card mt-3">
                    <div class="card-body">
                        <nav aria-label="Paginaci√≥n">
                            <ul id="pagination" class="pagination ta-pagination justify-content-center mb-0"></ul>
                        </nav>
                    </div>
                </div>
            </div> <!-- /col-lg-9 -->
        </div> <!-- /row -->
    </section>
</div>

<!-- MODAL -->
<div class="modal fade" id="propertyModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <form id="propertyForm" class="needs-validation" novalidate>
                <div class="modal-header">
                    <h5 class="modal-title">Crear propiedad</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>

                <div class="modal-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="title" class="form-label">T√≠tulo</label>
                            <input type="text" class="form-control" id="title" required />
                            <div class="invalid-feedback">Ingrese un t√≠tulo.</div>
                        </div>
                        <div class="col-md-6">
                            <label for="type" class="form-label">Tipo</label>
                            <select id="type" class="form-select" required>
                                <option value="" disabled selected>Seleccione...</option>
                                <option>Casa</option><option>Apartamento</option><option>Penthouse</option><option>Solar</option><option>Villa</option><option>Local Comercial</option>
                            </select>
                            <div class="invalid-feedback">Seleccione un tipo.</div>
                        </div>

                        <div class="col-md-6">
                            <label for="saleType" class="form-label">Transacci√≥n</label>
                            <select id="saleType" class="form-select" required>
                                <option value="" disabled selected>Seleccione...</option>
                                <option>Venta</option><option>Alquiler</option>
                            </select>
                            <div class="invalid-feedback">Seleccione venta o alquiler.</div>
                        </div>
                        <!-- Campo de precio por m¬≤ para solares -->
                        <div class="col-md-6" id="pricePerSqmContainer" style="display: none;">
                            <label for="pricePerSqm" class="form-label">üí∞ Precio por m¬≤ (RD$/m¬≤)</label>
                            <input type="number" class="form-control" id="pricePerSqm" min="0" step="0.01" placeholder="Ej: 5,000" />
                            <small class="form-text text-muted">Ingrese el precio por metro cuadrado. El precio total se calcular√° autom√°ticamente.</small>
                            <div class="invalid-feedback">Ingrese un precio v√°lido por m¬≤.</div>
                        </div>

                        <div class="col-md-6" id="priceContainer">
                            <label for="price" class="form-label d-flex align-items-center gap-2">
                                <span id="priceLabel">üí∞ Precio (RD$)</span>
                                <small id="priceAutoNote" class="text-muted d-none">
                                    (se calcular√° autom√°ticamente por unidades: menor precio)
                                </small>
                                <small id="priceAutoCalculated" class="text-success d-none">
                                    (calculado autom√°ticamente)
                                </small>
                            </label>
                            <input type="number" class="form-control" id="price" required min="0" step="0.01" placeholder="Ej: 2,500,000" />
                            <small class="form-text text-muted" id="priceHint">
                                Ingrese el precio total en Pesos Dominicanos (RD$). 
                                <span id="priceRangeHint"></span>
                            </small>
                            <div class="invalid-feedback">Ingrese un precio v√°lido en RD$.</div>
                        </div>

                        <div class="col-md-4">
                            <label for="bedrooms" class="form-label">Habitaciones</label>
                            <input type="number" class="form-control" id="bedrooms" required min="0" />
                        </div>
                        <div class="col-md-4">
                            <label for="bathrooms" class="form-label">Ba√±os</label>
                            <input type="number" class="form-control" id="bathrooms" required min="0" />
                        </div>
                        <div class="col-md-4">
                            <label for="parking" class="form-label">Parqueos</label>
                            <input type="number" class="form-control" id="parking" required min="0" />
                        </div>

                        <div class="col-md-6">
                            <label for="area" class="form-label">üìê √Årea (m¬≤)</label>
                            <input type="number" class="form-control" id="area" min="0" step="0.01" placeholder="Ej: 150" />
                            <small class="form-text text-muted" id="areaHint">Ingrese el √°rea en metros cuadrados.</small>
                        </div>
                        <div class="col-md-6">
                            <label for="address" class="form-label">Direcci√≥n</label>
                            <input type="text" class="form-control" id="address" />
                        </div>

                        <!-- Ubicaci√≥n con mapa -->
                        <div class="col-12">
                            <label class="form-label d-flex align-items-center justify-content-between">
                                <span>Ubicaci√≥n (elige en el mapa)</span>
                                <span class="d-flex gap-2">
                    <button type="button" id="btnUseMyLocation" class="btn btn-sm btn-outline-secondary">
                      <i class="bi bi-crosshair"></i> Mi ubicaci√≥n
                    </button>
                    <button type="button" id="btnClearMarker" class="btn btn-sm btn-outline-secondary">
                      <i class="bi bi-x-circle"></i> Limpiar
                    </button>
                  </span>
                            </label>
                            <div id="latLngPicker" class="map-picker rounded"></div>
                            <small class="text-muted">Haz clic en el mapa para fijar la ubicaci√≥n. Arrastra el marcador para ajustar.</small>
                        </div>

                        <div class="col-md-6">
                            <label for="latitude" class="form-label">Latitud</label>
                            <input type="number" class="form-control" id="latitude" step="0.000001" readonly />
                        </div>
                        <div class="col-md-6">
                            <label for="longitude" class="form-label">Longitud</label>
                            <input type="number" class="form-control" id="longitude" step="0.000001" readonly />
                        </div>

                        <div class="col-12">
                            <label for="descriptionParagraph" class="form-label">Descripci√≥n</label>
                            <textarea id="descriptionParagraph" class="form-control" rows="3"></textarea>
                        </div>

                        <!-- Caracter√≠sticas -->
                        <div class="col-12">
                            <label class="form-label">Caracter√≠sticas</label>
                            <div class="d-flex chip-input">
                                <input id="featureInput" class="form-control" placeholder="Ej: Terraza techada"/>
                                <button type="button" id="addFeatureBtn" class="btn btn-outline-primary">
                                    <i class="bi bi-plus-lg"></i> A√±adir
                                </button>
                            </div>
                            <div id="featuresList" class="chip-list mt-2"></div>
                        </div>

                        <!-- Amenidades -->
                        <div class="col-12" id="amenitiesSection">
                            <label class="form-label" for="amenityInput">Amenidades</label>
                            <div class="d-flex chip-input">
                                <input id="amenityInput" class="form-control" placeholder="Ej: Planta el√©ctrica"/>
                                <button type="button" id="addAmenityBtn" class="btn btn-outline-primary">
                                    <i class="bi bi-plus-lg"></i> A√±adir
                                </button>
                            </div>
                            <div id="amenitiesList" class="chip-list mt-2"></div>
                        </div>

                        <!-- Tipolog√≠as / Unidades -->
                        <div id="unitsSection" class="col-12 d-none">
                            <label class="form-label d-flex align-items-center justify-content-between">
                                <span>Tipolog√≠as / Unidades</span>
                                <small class="text-muted">Solo para Apartamento y Penthouse. El precio del anuncio se fija al menor precio.</small>
                            </label>

                            <div class="section-card p-3 mb-3">
                                <div class="row g-2 align-items-end">
                                    <div class="col-sm-3">
                                        <label class="form-label">Nombre</label>
                                        <input id="unitName" class="form-control" placeholder="Ej: A-101 / 2H-2B"/>
                                    </div>
                                    <div class="col-sm-2">
                                        <label class="form-label">Piso</label>
                                        <input id="unitFloor" type="number" class="form-control" min="0" placeholder="Ej: 1"/>
                                    </div>
                                    <div class="col-sm-1">
                                        <label class="form-label">Hab.</label>
                                        <input id="unitBedrooms" type="number" class="form-control" min="0" placeholder="0"/>
                                    </div>
                                    <div class="col-sm-1">
                                        <label class="form-label">Ba√±os</label>
                                        <input id="unitBathrooms" type="number" class="form-control" min="0" placeholder="0"/>
                                    </div>
                                    <div class="col-sm-1">
                                        <label class="form-label">Parq.</label>
                                        <input id="unitParking" type="number" class="form-control" min="0" placeholder="0"/>
                                    </div>
                                    <div class="col-sm-2">
                                        <label class="form-label">√Årea (m¬≤)</label>
                                        <input id="unitArea" type="number" class="form-control" min="0" step="0.01" placeholder="0"/>
                                    </div>
                                    <div class="col-sm-2">
                                        <label class="form-label">Precio</label>
                                        <input id="unitPrice" type="number" class="form-control" min="0" step="0.01" placeholder="0"/>
                                    </div>
                                    <div class="col-sm-12 col-md-auto">
                                        <button type="button" id="addUnitBtn" class="btn btn-outline-primary">
                                            <i class="bi bi-plus-lg"></i> A√±adir unidad
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="table table-sm align-middle">
                                    <thead>
                                    <tr>
                                        <th>Nombre</th><th>Piso</th><th>Hab.</th><th>Ba√±os</th><th>Parq.</th><th>√Årea (m¬≤)</th><th>Precio</th><th></th>
                                    </tr>
                                    </thead>
                                    <tbody id="unitsList"></tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Im√°genes -->
                        <div class="col-12">
                            <label class="form-label">Im√°genes (m√°x 100)</label>
                            <div id="imageDropZone" class="image-drop-zone">
                                <i class="bi bi-cloud-upload fs-1"></i>
                                <p class="mb-2">Arrastra im√°genes aqu√≠ o haz clic para seleccionar</p>
                                <small class="text-muted">Soporta: JPG, PNG, GIF, BMP, WebP, SVG, TIFF (hasta 25MB por imagen)</small>
                                <input id="imageFiles" type="file" class="d-none" multiple accept="image/jpeg,image/png,image/gif,image/bmp,image/webp,image/svg+xml,image/tiff">
                            </div>
                            <div id="imagePreview" class="image-grid mt-2"></div>
                            <div class="form-text">
                                <span id="imageCount" class="limit">0</span>/100 seleccionadas
                                <span id="uploadProgress" class="ms-3 text-primary d-none"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-bs-dismiss="modal">Cerrar</button>
                    <button class="btn btn-primary" type="submit">Guardar Propiedad</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="js/includeHeader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="js/validation.js"></script>
<script src="js/admin.js"></script>
</body>
</html>
